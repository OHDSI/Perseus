<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Execute and View Data Quality Checks on OMOP CDM Database • DataQualityDashboard</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Execute and View Data Quality Checks on OMOP CDM Database">
<meta property="og:description" content="An R package for assessing data quality in standardized OMOP Common Data Model data sources.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">DataQualityDashboard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/OHDSI/DataQualityDashboard/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="dataqualitydashboard" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#dataqualitydashboard" class="anchor"></a>DataQualityDashboard</h1></div>

<p>The goal of the Data Quality Dashboard (DQD) project is to design and develop an open-source tool to expose and evaluate observational data quality.</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This package will run a series of data quality checks against an OMOP CDM instance (currently supports v5.3.1 and v5.2.2). It systematically runs the checks, evaluates the checks against some pre-specified threshold, and then communicates what was done in a transparent and easily understandable way.</p>
</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>The quality checks were organized according to the Kahn Framework<sup id="kahn"><a href="#f1">1</a></sup> which uses a system of categories and contexts that represent stratgies for assessing data quality. ##TODO for an introduction to the kahn framework please click [here] link.</p>
<p>Using this framework, the Data Quality Dashboard takes a systematic-based approach to running data quality checks. Instead of writing thousands of individual checks, we use “data quality check types”. These “check types” are more general, parameterized data quality checks into which OMOP tables, fields, and concepts can be substituted to represent a singular data quality idea. For example, one check type might be written as</p>
<blockquote>
<p>The number and percent of records with a value in the <strong>cdmFieldName</strong> field of the <strong>cdmTableName</strong> table less than <strong>plausibleValueLow</strong>.</p>
</blockquote>
<p>This would be considered an atemporal plausibility verification check because we are looking for implausibly low values in some field based on internal knowledge. We can use this check type to substitute in values for <strong>cdmFieldName</strong>, <strong>cdmTableName</strong>, and <strong>plausibleValueLow</strong> to create a unique data quality check. If we apply it to PERSON.YEAR_OF_BIRTH here is how that might look:</p>
<blockquote>
<p>The number and percent of records with a value in the <strong>year_of_birth</strong> field of the <strong>PERSON</strong> table less than <strong>1850</strong>.</p>
</blockquote>
<p>And, since it is parameterized, we can similarly apply it to DRUG_EXPOSURE.days_supply:</p>
<blockquote>
<p>The number and percent of records with a value in the <strong>days_supply</strong> field of the <strong>DRUG_EXPOSURE</strong> table less than <strong>0</strong>.</p>
</blockquote>
<p>Version 1 of the tool includes 20 different check types organized into Kahn contexts and categories. Additionally, each data quality check type is considered either a table check, field check, or concept-level check. Table-level checks are those evaluating the table at a high-level without reference to individual fields, or those that span multiple event tables. These include checks making sure required tables are present or that at least some of the people in the PERSON table have records in the event tables. Field-level checks are those related to specific fields in a table. The majority of the check types in version 1 are field-level checks. These include checks evaluating primary key relationship and those investigating if the concepts in a field conform to the specified domain. Concept-level checks are related to individual concepts. These include checks looking for gender-specific concepts in persons of the wrong gender and plausible values for measurement-unit pairs. ##TODO The below table lists all check types, the check level (table, field, concept), a description of the check, and Kahn category and context it fits into. <strong>Remove table, click here for more information on the checks included</strong></p>
<p>After systematically applying the 20 check types to an OMOP CDM version approximately 3,351 individual data quality checks are resolved, run against the database, and evaluated based on a pre-specified threshold ##TODO [more about thresholds here]. The R package then creates a json object that is read into an RShiny application to view the results.</p>
<p><img src="https://github.com/OHDSI/DataQualityDashboard/raw/master/extras/dqDashboardScreenshot.png"></p>
</div>
<div id="features" class="section level1">
<h1 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h1>
<ul>
<li>Utilizes configurable data check thresholds</li>
<li>Analyzes data in the OMOP Common Data Model format for all data checks</li>
<li>Produces a set of data check results with supplemental investigation assets.</li>
</ul>
</div>
<div id="technology" class="section level1">
<h1 class="hasAnchor">
<a href="#technology" class="anchor"></a>Technology</h1>
<p>DataQualityDashboard is an R package</p>
</div>
<div id="system-requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#system-requirements" class="anchor"></a>System Requirements</h1>
<p>Requires R (version 3.2.2 or higher). Requires <a href="https://github.com/OHDSI/DatabaseConnector">DatabaseConnector</a> and <a href="https://github.com/OHDSI/SqlRender">SqlRender</a>.</p>
</div>
<div id="r-installation" class="section level1">
<h1 class="hasAnchor">
<a href="#r-installation" class="anchor"></a>R Installation</h1>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_github</a></span>(<span class="st">"OHDSI/DataQualityDashboard"</span>)</pre></div>
</div>
<div id="executing-data-quality-checks" class="section level1">
<h1 class="hasAnchor">
<a href="#executing-data-quality-checks" class="anchor"></a>Executing Data Quality Checks</h1>
<div class="sourceCode" id="cb2"><pre class="r">
<span class="co"># fill out the connection details -----------------------------------------------------------------------</span>
<span class="no">connectionDetails</span> <span class="kw">&lt;-</span> <span class="kw pkg">DatabaseConnector</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/DatabaseConnector/man/createConnectionDetails.html">createConnectionDetails</a></span>(<span class="kw">dbms</span> <span class="kw">=</span> <span class="st">""</span>,
                                                              <span class="kw">user</span> <span class="kw">=</span> <span class="st">""</span>,
                                                              <span class="kw">password</span> <span class="kw">=</span> <span class="st">""</span>,
                                                              <span class="kw">server</span> <span class="kw">=</span> <span class="st">""</span>,
                                                              <span class="kw">port</span> <span class="kw">=</span> <span class="st">""</span>,
                                                              <span class="kw">extraSettings</span> <span class="kw">=</span> <span class="st">""</span>)

<span class="no">cdmDatabaseSchema</span> <span class="kw">&lt;-</span> <span class="st">"yourCdmSchema"</span> <span class="co"># the fully qualified database schema name of the CDM</span>
<span class="no">resultsDatabaseSchema</span> <span class="kw">&lt;-</span> <span class="st">"yourResultsSchema"</span> <span class="co"># the fully qualified database schema name of the results schema (that you can write to)</span>
<span class="no">cdmSourceName</span> <span class="kw">&lt;-</span> <span class="st">"Your CDM Source"</span> <span class="co"># a human readable name for your CDM source</span>

<span class="co"># determine how many threads (concurrent SQL sessions) to use ----------------------------------------</span>
<span class="no">numThreads</span> <span class="kw">&lt;-</span> <span class="fl">1</span> <span class="co"># on Redshift, 3 seems to work well</span>

<span class="co"># specify if you want to execute the queries or inspect them ------------------------------------------</span>
<span class="no">sqlOnly</span> <span class="kw">&lt;-</span> <span class="fl">FALSE</span> <span class="co"># set to TRUE if you just want to get the SQL scripts and not actually run the queries</span>

<span class="co"># where should the logs go? -------------------------------------------------------------------------</span>
<span class="no">outputFolder</span> <span class="kw">&lt;-</span> <span class="st">"output"</span>

<span class="co"># logging type -------------------------------------------------------------------------------------</span>
<span class="no">verboseMode</span> <span class="kw">&lt;-</span> <span class="fl">FALSE</span> <span class="co"># set to TRUE if you want to see activity written to the console</span>

<span class="co"># write results to table? ------------------------------------------------------------------------------</span>
<span class="no">writeToTable</span> <span class="kw">&lt;-</span> <span class="fl">TRUE</span> <span class="co"># set to FALSE if you want to skip writing to a SQL table in the results schema</span>

<span class="co"># if writing to table and using Redshift, bulk loading can be initialized -------------------------------</span>

<span class="co"># Sys.setenv("AWS_ACCESS_KEY_ID" = "",</span>
<span class="co">#            "AWS_SECRET_ACCESS_KEY" = "",</span>
<span class="co">#            "AWS_DEFAULT_REGION" = "",</span>
<span class="co">#            "AWS_BUCKET_NAME" = "",</span>
<span class="co">#            "AWS_OBJECT_KEY" = "",</span>
<span class="co">#            "AWS_SSE_TYPE" = "AES256",</span>
<span class="co">#            "USE_MPP_BULK_LOAD" = TRUE)</span>

<span class="co"># which DQ check levels to run -------------------------------------------------------------------</span>
<span class="no">checkLevels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TABLE"</span>, <span class="st">"FIELD"</span>, <span class="st">"CONCEPT"</span>)

<span class="co"># which DQ checks to run? ------------------------------------</span>

<span class="no">checkNames</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>() <span class="co"># Names can be found in inst/csv/OMOP_CDM_v5.3.1_Check_Desciptions.csv</span>

<span class="co"># run the job --------------------------------------------------------------------------------------</span>
<span class="kw pkg">DataQualityDashboard</span><span class="kw ns">::</span><span class="fu"><a href="reference/executeDqChecks.html">executeDqChecks</a></span>(<span class="kw">connectionDetails</span> <span class="kw">=</span> <span class="no">connectionDetails</span>,
                                    <span class="kw">cdmDatabaseSchema</span> <span class="kw">=</span> <span class="no">cdmDatabaseSchema</span>,
                                    <span class="kw">resultsDatabaseSchema</span> <span class="kw">=</span> <span class="no">resultsDatabaseSchema</span>,
                                    <span class="kw">cdmSourceName</span> <span class="kw">=</span> <span class="no">cdmSourceName</span>,
                                    <span class="kw">numThreads</span> <span class="kw">=</span> <span class="no">numThreads</span>,
                                    <span class="kw">sqlOnly</span> <span class="kw">=</span> <span class="no">sqlOnly</span>,
                                    <span class="kw">outputFolder</span> <span class="kw">=</span> <span class="no">outputFolder</span>,
                                    <span class="kw">verboseMode</span> <span class="kw">=</span> <span class="no">verboseMode</span>,
                                    <span class="kw">writeToTable</span> <span class="kw">=</span> <span class="no">writeToTable</span>,
                                    <span class="kw">checkLevels</span> <span class="kw">=</span> <span class="no">checkLevels</span>,
                                    <span class="kw">checkNames</span> <span class="kw">=</span> <span class="no">checkNames</span>)

<span class="co"># inspect logs ----------------------------------------------------------------------------</span>
<span class="kw pkg">ParallelLogger</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ParallelLogger/man/launchLogViewer.html">launchLogViewer</a></span>(<span class="kw">logFileName</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="no">outputFolder</span>, <span class="no">cdmSourceName</span>,
                                                      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"log_DqDashboard_%s.txt"</span>, <span class="no">cdmSourceName</span>)))

<span class="co"># (OPTIONAL) if you want to write the JSON file to the results table separately -----------------------------</span>
<span class="no">jsonFilePath</span> <span class="kw">&lt;-</span> <span class="st">""</span>
<span class="kw pkg">DataQualityDashboard</span><span class="kw ns">::</span><span class="fu"><a href="reference/writeJsonResultsToTable.html">writeJsonResultsToTable</a></span>(<span class="kw">connectionDetails</span> <span class="kw">=</span> <span class="no">connectionDetails</span>,
                                            <span class="kw">resultsDatabaseSchema</span> <span class="kw">=</span> <span class="no">resultsDatabaseSchema</span>,
                                            <span class="kw">jsonFilePath</span> <span class="kw">=</span> <span class="no">jsonFilePath</span>)</pre></div>
</div>
<div id="viewing-results" class="section level1">
<h1 class="hasAnchor">
<a href="#viewing-results" class="anchor"></a>Viewing Results</h1>
<p><strong>Launching Dashboard as Shiny App</strong></p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="kw pkg">DataQualityDashboard</span><span class="kw ns">::</span><span class="fu"><a href="reference/viewDqDashboard.html">viewDqDashboard</a></span>(<span class="kw">jsonPath</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span>(), <span class="no">outputFolder</span>, <span class="no">cdmSourceName</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"results_%s.json"</span>, <span class="no">cdmSourceName</span>)))</pre></div>
<p><strong>Launching on a web server</strong></p>
<p>If you have npm installed:</p>
<ol>
<li>Install http-server:</li>
</ol>
<pre><code>npm install -g http-server</code></pre>
<ol>
<li><p>Rename the json file to <em>results.json</em> and place it in inst/shinyApps/www</p></li>
<li><p>Go to inst/shinyApps/www, then run:</p></li>
</ol>
<pre><code>http-server</code></pre>
<p>A results JSON file for the Synthea synthetic dataset will be shown. You can view your results by replacing the results.json file with your file (with name results.json).</p>
</div>
<div id="view-checks" class="section level1">
<h1 class="hasAnchor">
<a href="#view-checks" class="anchor"></a>View checks</h1>
<p>To see description of checks using R, execute the command bellow:</p>
<pre><code><a href="https://rdrr.io/r/utils/View.html">View(read.csv(system.file("csv","OMOP_CDMv5.3.1_Check_Descriptions.csv",package="DataQualityDashboard"),as.is=T))</a></code></pre>
</div>
<div id="support" class="section level1">
<h1 class="hasAnchor">
<a href="#support" class="anchor"></a>Support</h1>
<ul>
<li>Developer questions/comments/feedback: <a href="http://forums.ohdsi.org/c/developers">OHDSI Forum</a>
</li>
<li>We use the <a href="https://github.com/OHDSI/DataQualityDashboard/issues">GitHub issue tracker</a> for all bugs/issues/enhancements</li>
</ul>
</div>
<div id="license" class="section level1">
<h1 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h1>
<p>DataQualityDashboard is licensed under Apache License 2.0</p>
<div id="development-status" class="section level3">
<h3 class="hasAnchor">
<a href="#development-status" class="anchor"></a>Development status</h3>
<p>V1.0 ready for use.</p>
</div>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>This project is supported in part through the National Science Foundation grant IIS 1251151.</p>
<p><b id="f1">1</b> Kahn, M.G., et al., A Harmonized Data Quality Assessment Terminology and Framework for the Secondary Use of Electronic Health Record Data. EGEMS (Wash DC), 2016. 4(1): p. 1244. <a href="#kahn">↩︎</a></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/OHDSI/DataQualityDashboard/">https://​github.com/​OHDSI/​DataQualityDashboard/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/OHDSI/DataQualityDashboard/issues">https://​github.com/​OHDSI/​DataQualityDashboard/​issues</a>
</li>
<li>Ask a question at <br><a href="http://forums.ohdsi.org">http://​forums.ohdsi.org</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>Apache License 2.0</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Clair Blacketer <br><small class="roles"> Author, maintainer </small>  </li>
<li>Ajit Londhe <br><small class="roles"> Author </small>  </li>
<li>Anthony Sena <br><small class="roles"> Author </small>  </li>
<li>Anthony Molinaro <br><small class="roles"> Author </small>  </li>
<li>Frank DeFalco <br><small class="roles"> Author </small>  </li>
<li>Pavel Grafkin <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/OHDSI/DataQualityDashboard"><img src="https://travis-ci.org/OHDSI/DataQualityDashboard.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/github/OHDSI/DataQualityDashboard?branch=master"><img src="https://codecov.io/github/OHDSI/DataQualityDashboard/coverage.svg?branch=master" alt="codecov.io"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Clair Blacketer, Ajit Londhe, Anthony Sena, Anthony Molinaro, Frank DeFalco, Pavel Grafkin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
