{
  "mapping": [
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "ENROLID",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "PersonId"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "ENROLID",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "PersonSourceValue"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "DTSTART",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "StartDate"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "DTEND",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "EndDate"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "SEX",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "Gender"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "DOBYR",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "YearOfBirth"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "EGEOLOC",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "Location"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "RACE_SOURCE_VALUE",
      "sql_field": "null",
      "sql_alias": "RACE_SOURCE_VALUE",
      "target_field": "Race"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "RACE_CONCEPT_ID",
      "sql_field": "null",
      "sql_alias": "RACE_CONCEPT_ID",
      "target_field": "RaceConceptId"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "ETHNICITY_SOURCE_VALUE",
      "sql_field": "null",
      "sql_alias": "ETHNICITY_SOURCE_VALUE",
      "target_field": "Ethnicity"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "ETHNICITY_CONCEPT_ID",
      "sql_field": "null",
      "sql_alias": "ETHNICITY_CONCEPT_ID",
      "target_field": "EthnicityConceptId"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Persons",
      "source_field": "PeriodTypeConceptId",
      "sql_field": "44814722",
      "sql_alias": "PeriodTypeConceptId",
      "target_field": "PeriodTypeConceptId"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "PayerPlanPeriods",
      "source_field": "ENROLID",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "PersonId"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "PayerPlanPeriods",
      "source_field": "DTSTART",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "StartDate"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "PayerPlanPeriods",
      "source_field": "DTEND",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "EndDate"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "PayerPlanPeriods",
      "source_field": "PLANTYP",
      "sql_field": "CASE      WHEN DATATYP IN (2,4) THEN 'C '      ELSE 'N '      END      + CASE PLANTYP      WHEN 1 THEN '{prefix} Basic/Major Medical'      WHEN 2 THEN '{prefix} Comprehensive'      WHEN 3 THEN '{prefix} EPO'      WHEN 4 THEN '{prefix} HMO'      WHEN 5 THEN '{prefix} POS'      WHEN 6 THEN '{prefix} PPO'      WHEN 7 THEN '{prefix} POS with Capitation'      WHEN 8 THEN '{prefix} CDHP'      WHEN 9 THEN '{prefix} HDHP'      ELSE '{prefix} Other'      END",
      "sql_alias": "PayerSource",
      "target_field": "PayerSource"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "PayerPlanPeriods",
      "source_field": "PLANKEY",
      "sql_field": "null",
      "sql_alias": "PLANKEY",
      "target_field": "PlanSource"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "PayerPlanPeriods",
      "source_field": "ENROLID",
      "sql_field": "SUBSTRING(RIGHT('00000000000' + cast(ENROLID as VARCHAR), 11), 1,9)",
      "sql_alias": "FamilySource",
      "target_field": "FamilySource"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Observation",
      "source_field": "ENROLID",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "PersonId"
    },
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Observation",
      "source_field": "DTEND",
      "sql_field": "",
      "sql_alias": "",
      "target_field": "StartDate"
    }
  ],
  "lookup": [
    {
      "source_table": "ENROLLMENT_DETAIL",
      "target_table": "Observation",
      "fields": [
        {
          "conceptId": "OBSERVATION_CONCEPT_ID",
          "sourceKey": "OBSERVATION_SOURCE_VALUE",
          "defaultTypeId": "900000009"
        }
      ],
      "lookup": ""
    }
  ]
}