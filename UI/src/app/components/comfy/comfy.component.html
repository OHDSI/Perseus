<div class="comfy-container">
  <app-saved-mappings
    [tablesconfiguration]="target"
    (reset)="resetAllMappings()"
    (load)="loadConfiguration($event)"
  ></app-saved-mappings>
  <div class="instruction">
    In order to make mapping, move source table to the target table
  </div>
  <div class="comfy">
    <div class="mapping-component-progress" *ngIf="busy">
      <mat-progress-spinner [mode]="'indeterminate'" [color]="'accent'">
      </mat-progress-spinner>
    </div>
    <ng-container *ngIf="!busy">
      <div class="vertical-container">
        <h2>Source columns</h2>
        <app-columns-list
          [tables]="sourceTables"
          (columnsSelected)="findTables($event)"
        ></app-columns-list>
      </div>
      <div class="vertical-container source">
        <h2>Source tables</h2>

        <div
          cdkDropList
          cdkDropListSortingDisabled
          #sourceList="cdkDropList"
          [cdkDropListData]="source"
          [cdkDropListConnectedTo]="sourceConnectedTo"
          class="vertical-list"
          (cdkDropListDropped)="drop($event)"
        >
          <div class="vertical-box" cdkDrag *ngFor="let item of source">
            <div
              class="table-description source caption"
              matTooltip="{{ item }}"
              matTooltipPosition="right"
              [attr.criteria]="item"
              highlight
              [values]="highlitedTables"
            >
              {{ item }}
            </div>
          </div>
        </div>
      </div>
      <div class="vertical-container destination" cdkDropListGroup>
        <h2>Target tables</h2>

        <div
          *ngFor="let targetName of targetTableNames"
          cdkDropList
          cdkDropListSortingDisabled
          cdkDropListOrientation="horizontal"
          id="{{ target[targetName].name }}"
          [cdkDropListData]="target[targetName].data"
          class="horizontal-list"
          (cdkDropListDropped)="drop($event)"
        >
          <div
            class="horizontal-box"
            *ngFor="let tableName of target[targetName].data"
          >
            <div
              class="table-description target caption"
              (click)="openMapping(tableName)"
            >
              {{ tableName }}
              <mat-icon
                class="remove-mapping-table"
                (click)="removeTableMapping($event, tableName, targetName)"
                >close</mat-icon
              >
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>
